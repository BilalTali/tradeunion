import{a as E,r as S,u as p,j as e,H as A,L as u}from"./app-DnjC0X-L.js";import{A as P}from"./AuthenticatedLayout-C6iiLxKS.js";import{I as a}from"./InputError-rIEQ9CjR.js";import{I as d}from"./InputLabel-DyCNJ4Se.js";import{P as g}from"./PrimaryButton-kL8pZvQ4.js";import{T as i}from"./TextInput-DKqreoEz.js";function R({auth:j,calendars:o}){const{flash:m}=E().props,[t,v]=S.useState(o[0]||null),{data:x,setData:n,post:f,processing:y,errors:h,reset:N}=p({year:new Date().getFullYear(),file:null,is_active:!0}),b=s=>{s.preventDefault(),f(route("state.calendars.store"),{onSuccess:()=>N()})},{data:r,setData:l,post:w,processing:D,errors:c,reset:_}=p({title:"",start_date:"",end_date:"",description:"",is_holiday:!1}),C=s=>{s.preventDefault(),t&&w(route("state.calendars.events.store",t.id),{onSuccess:()=>_(),preserveScroll:!0})};return e.jsxs(P,{user:j.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Academic Calendar Managment"}),children:[e.jsx(A,{title:"Academic Calendar"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8 space-y-6",children:[m.success&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",role:"alert",children:e.jsx("span",{className:"block sm:inline",children:m.success})}),e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Add New Calendar Year"}),e.jsxs("form",{onSubmit:b,className:"grid grid-cols-1 md:grid-cols-4 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"year",value:"Year"}),e.jsx(i,{id:"year",type:"number",className:"mt-1 block w-full",value:x.year,onChange:s=>n("year",s.target.value),required:!0}),e.jsx(a,{message:h.year,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"file",value:"PDF (Optional)"}),e.jsx("input",{type:"file",id:"file",className:"mt-1 block w-full text-sm",onChange:s=>n("file",s.target.files[0]),accept:".pdf"}),e.jsx(a,{message:h.file,className:"mt-1"})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center mt-4",children:[e.jsx("input",{type:"checkbox",className:"rounded border-gray-300 text-indigo-600 shadow-sm focus:ring-indigo-500",checked:x.is_active,onChange:s=>n("is_active",s.target.checked)}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Active"})]})}),e.jsx("div",{children:e.jsx(g,{disabled:y,children:"Add Calendar"})})]})]}),e.jsxs("div",{className:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-6",children:[e.jsx("div",{className:"flex gap-4 mb-6 overflow-x-auto pb-2",children:o.map(s=>e.jsxs("button",{onClick:()=>v(s),className:`px-4 py-2 rounded-lg whitespace-nowrap ${t?.id===s.id?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:[s.year," (",s.events.length," Events)"]},s.id))}),t?e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold",children:["Events for ",t.year]}),t.file_path&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("a",{href:`/storage/${t.file_path}`,target:"_blank",className:"text-blue-600 hover:underline",children:"View PDF"}),e.jsx(u,{href:route("state.calendars.file.destroy",t.id),method:"delete",as:"button",className:"text-red-500 hover:text-red-700 text-sm",onClick:s=>{confirm("Are you sure you want to remove the PDF?")||s.preventDefault()},children:"Delete PDF"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6 border",children:[e.jsx("h4",{className:"text-sm font-semibold mb-3 uppercase text-gray-500",children:"Add Event"}),e.jsxs("form",{onSubmit:C,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(i,{placeholder:"Event Title",className:"w-full",value:r.title,onChange:s=>l("title",s.target.value),required:!0}),e.jsx(a,{message:c.title,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(d,{value:"Start Date"}),e.jsx(i,{type:"date",className:"w-full",value:r.start_date,onChange:s=>l("start_date",s.target.value),required:!0}),e.jsx(a,{message:c.start_date,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(d,{value:"End Date (Optional)"}),e.jsx(i,{type:"date",className:"w-full",value:r.end_date,onChange:s=>l("end_date",s.target.value)}),e.jsx(a,{message:c.end_date,className:"mt-1"})]}),e.jsxs("div",{className:"md:col-span-2 flex items-center justify-between",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",className:"rounded border-gray-300",checked:r.is_holiday,onChange:s=>l("is_holiday",s.target.checked)}),e.jsx("span",{className:"ml-2",children:"Is Holiday"})]}),e.jsx(g,{disabled:D,children:"Add Event"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider",children:"Event"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.events.length>0?t.events.map(s=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:[new Date(s.start_date).toLocaleDateString(),s.end_date&&` - ${new Date(s.end_date).toLocaleDateString()}`]}),e.jsx("td",{className:"px-4 py-2 text-sm font-medium",children:s.title}),e.jsx("td",{className:"px-4 py-2",children:s.is_holiday&&e.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded",children:"Holiday"})}),e.jsx("td",{className:"px-4 py-2 text-right",children:e.jsx(u,{href:route("state.calendars.events.destroy",s.id),method:"delete",as:"button",className:"text-red-500 hover:text-red-700 text-sm",onClick:k=>{confirm("Remove event?")||k.preventDefault()},children:"Remove"})})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-4 py-2 text-center text-sm text-gray-500",children:"No events added yet."})})})]})})]}):e.jsx("p",{className:"text-center text-gray-500",children:"Select a calendar year to manage events."})]})]})})]})}export{R as default};
