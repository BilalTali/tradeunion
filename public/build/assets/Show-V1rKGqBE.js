import{a as A,r as j,u as L,j as e,H as M,L as f,b as N}from"./app-DvqN5tN9.js";import{A as E}from"./AuthenticatedLayout-DTMwTJmp.js";function S({resolution:s,canVote:y,hasVoted:m,userVote:n,votingStats:r}){const{auth:v}=A().props,l=v.user.role,[w,d]=j.useState(!1),[_,h]=j.useState(null),a=l==="super_admin"||l.includes("state")?"state":l.includes("district")?"district":l.includes("tehsil")?"tehsil":"state",{data:C,setData:g,post:k,processing:u}=L({vote:"",notes:""}),c=t=>{h(t),g("vote",t),d(!0)},V=t=>{t.preventDefault(),k(route(`${a}.resolutions.vote`,s.id),{onSuccess:()=>{d(!1),h(null)}})},i=t=>{if(confirm({"open-voting":"Open voting on this resolution? All committee members will be able to vote.","close-voting":"Close voting and finalize results? This will determine if the resolution passes or fails.",execute:"Execute this resolution? This action will be recorded and cannot be undone.",cancel:"Cancel this resolution? This will mark it as cancelled."}[t]))if(t==="execute"){const R=prompt("Execution notes (optional):");N.post(route(`${a}.resolutions.${t}`,s.id),{execution_notes:R})}else N.post(route(`${a}.resolutions.${t}`,s.id))},$=t=>({draft:"bg-gray-100 text-gray-800",voting:"bg-blue-100 text-blue-800",passed:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800",executed:"bg-purple-100 text-purple-800"})[t]||"bg-gray-100 text-gray-800",D=t=>({disciplinary:"bg-red-50 text-red-700 border-red-200",administrative:"bg-blue-50 text-blue-700 border-blue-200",financial:"bg-green-50 text-green-700 border-green-200",election:"bg-purple-50 text-purple-700 border-purple-200",policy:"bg-yellow-50 text-yellow-700 border-yellow-200"})[t]||"bg-gray-50 text-gray-700 border-gray-200",o=r?r.votesReceived/r.totalMembers*100:0,x=o>=(s.committee?.quorum_percentage||50),b=r&&r.totalVotes>0?s.votes_for/r.totalVotes*100:0;return e.jsxs(E,{children:[e.jsx(M,{title:s.title}),e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(f,{href:route(`${a}.resolutions.index`),className:"inline-flex items-center text-sm font-medium text-gray-500 hover:text-gray-700 mb-6",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back to Resolutions"]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("div",{className:"flex items-start justify-between mb-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${$(s.status)}`,children:s.status.toUpperCase()}),e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium border ${D(s.type)}`,children:s.type})]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 font-mono",children:s.resolution_number})]})}),e.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-6 pt-6 border-t",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Committee"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:s.committee?.name})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Category"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 capitalize",children:s.category?.replace(/_/g," ")})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Proposed By"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:s.proposer?.position_title||"N/A"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Proposed On"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:new Date(s.created_at).toLocaleString()})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Proposal"}),e.jsx("div",{className:"prose prose-sm max-w-none",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s.proposal_text})}),s.rationale&&e.jsxs("div",{className:"mt-6 pt-6 border-t",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-2",children:"Rationale"}),e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s.rationale})]}),s.proposed_action&&e.jsxs("div",{className:"mt-6 pt-6 border-t",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-2",children:"Proposed Action"}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsx("pre",{className:"text-sm text-blue-900 whitespace-pre-wrap font-mono",children:JSON.stringify(s.proposed_action,null,2)})})]})]}),y&&s.status==="voting"&&!m&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg shadow-sm border-2 border-blue-300 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cast Your Vote"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"As a committee member, your vote is required on this resolution."}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>c("for"),className:"p-4 bg-white border-2 border-green-500 rounded-lg hover:bg-green-50 transition text-center group",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ‘"}),e.jsx("div",{className:"font-semibold text-green-700",children:"For"})]}),e.jsxs("button",{onClick:()=>c("against"),className:"p-4 bg-white border-2 border-red-500 rounded-lg hover:bg-red-50 transition text-center group",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ‘Ž"}),e.jsx("div",{className:"font-semibold text-red-700",children:"Against"})]}),e.jsxs("button",{onClick:()=>c("abstain"),className:"p-4 bg-white border-2 border-gray-400 rounded-lg hover:bg-gray-50 transition text-center group",children:[e.jsx("div",{className:"text-3xl mb-2",children:"ðŸ¤·"}),e.jsx("div",{className:"font-semibold text-gray-700",children:"Abstain"})]})]})]}),m&&n&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 text-green-600 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-green-900",children:["You voted: ",e.jsx("span",{className:"uppercase font-bold",children:n.vote})]}),e.jsxs("p",{className:"text-xs text-green-700 mt-1",children:["Cast on ",new Date(n.vote_cast_at).toLocaleString()]})]})]})}),s.status==="executed"&&s.executed_at&&e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-900 mb-3",children:"Execution Details"}),e.jsxs("dl",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-purple-700 font-medium",children:"Executed By:"}),e.jsx("dd",{className:"text-purple-900",children:s.executor?.position_title||"N/A"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-purple-700 font-medium",children:"Executed On:"}),e.jsx("dd",{className:"text-purple-900",children:new Date(s.executed_at).toLocaleString()})]}),s.execution_notes&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-purple-700 font-medium",children:"Notes:"}),e.jsx("dd",{className:"text-purple-900",children:s.execution_notes})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[(s.status==="voting"||s.status==="passed"||s.status==="rejected"||s.status==="executed")&&r&&e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-4",children:"Voting Statistics"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Quorum"}),e.jsx("span",{className:`text-sm font-semibold ${x?"text-green-600":"text-red-600"}`,children:x?"Met âœ“":"Not Met âœ—"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full ${x?"bg-green-600":"bg-red-600"}`,style:{width:`${Math.min(o,100)}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[r.votesReceived," of ",r.totalMembers," members (",Math.round(o),"%)",e.jsx("br",{}),"Required: ",r.quorumRequired," (",s.committee?.quorum_percentage,"%)"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"For"}),e.jsx("span",{className:"text-sm font-semibold text-green-600",children:s.votes_for})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${b}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Against"}),e.jsx("span",{className:"text-sm font-semibold text-red-600",children:s.votes_against})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-red-600 h-2 rounded-full",style:{width:`${r.totalVotes>0?s.votes_against/r.totalVotes*100:0}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Abstain"}),e.jsx("span",{className:"text-sm font-semibold text-gray-600",children:s.votes_abstain})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gray-400 h-2 rounded-full",style:{width:`${r.totalVotes>0?s.votes_abstain/r.totalVotes*100:0}%`}})})]})]}),s.committee?.voting_threshold&&e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("strong",{children:"Passing Threshold:"})," ",s.committee.voting_threshold,"%",e.jsx("br",{}),e.jsx("strong",{children:"Current For:"})," ",Math.round(b),"%"]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-4",children:"Actions"}),e.jsxs("div",{className:"space-y-2",children:[s.status==="draft"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>i("open-voting"),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition font-medium text-sm",children:"Open Voting"}),e.jsx("button",{onClick:()=>i("cancel"),className:"w-full px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition font-medium text-sm",children:"Cancel Resolution"})]}),s.status==="voting"&&e.jsx("button",{onClick:()=>i("close-voting"),className:"w-full px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 transition font-medium text-sm",children:"Close Voting"}),s.status==="passed"&&e.jsx("button",{onClick:()=>i("execute"),className:"w-full px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition font-medium text-sm",children:"Execute Resolution"}),e.jsx(f,{href:route(`${a}.resolutions.index`),className:"block w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition text-center font-medium text-sm",children:"Back to List"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-md font-semibold text-gray-900 mb-4",children:"Important Dates"}),e.jsxs("dl",{className:"space-y-3 text-sm",children:[s.effective_date&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-500 font-medium",children:"Effective Date"}),e.jsx("dd",{className:"text-gray-900",children:new Date(s.effective_date).toLocaleDateString()})]}),s.expires_date&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-500 font-medium",children:"Expires On"}),e.jsx("dd",{className:"text-gray-900",children:new Date(s.expires_date).toLocaleDateString()})]}),s.vote_scheduled_date&&e.jsxs("div",{children:[e.jsx("dt",{className:"text-gray-500 font-medium",children:"Vote Scheduled"}),e.jsx("dd",{className:"text-gray-900",children:new Date(s.vote_scheduled_date).toLocaleDateString()})]})]})]})]})]}),w&&e.jsx("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen px-4",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:()=>d(!1)}),e.jsxs("div",{className:"relative bg-white rounded-lg max-w-md w-full p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Confirm Vote: ",e.jsx("span",{className:"uppercase text-blue-600",children:_})]}),e.jsxs("form",{onSubmit:V,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Optional Notes"}),e.jsx("textarea",{value:C.notes,onChange:t=>g("notes",t.target.value),rows:"3",className:"w-full border-gray-300 rounded-lg shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-200",placeholder:"Explain your vote (optional)..."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>d(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:u?"Submitting...":"Confirm Vote"})]})]})]})]})})]})})]})}export{S as default};
