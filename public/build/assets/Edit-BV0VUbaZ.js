import{a as y,r as j,u as v,j as e,H as N,L as _}from"./app-XCtiZVKQ.js";import{A as w}from"./AuthenticatedLayout-CTGkoCvp.js";import{R as k}from"./RichTextEditor-BnDvTeZB.js";function D({post:a,categories:m,portfolios:d=[]}){const{auth:o}=y().props,[i,c]=j.useState(!1),n=(()=>{const t=o.user?.role||"";return t==="super_admin"?"state":t.includes("district")?"district":t.includes("tehsil")?"tehsil":"state"})(),{data:r,setData:s,post:g,processing:x,errors:l}=v({title:a.title||"",content:a.content||"",excerpt:a.excerpt||"",category:a.category||"article",publish_date:a.publish_date||"",status:a.status||"draft",visibility:a.visibility||"members_only",featured_image:null,_method:"PUT",event_type:a.event_type||"meeting",event_scope:a.event_scope||"tehsil",start_date:a.start_date||"",end_date:a.end_date||"",venue:a.venue||"",organizer_portfolio_id:a.organizer_portfolio_id||"",priority:a.priority||"normal",expiry_date:a.expiry_date||""}),h=t=>{t.preventDefault(),g(route(`${n}.blog.update`,a.id),{forceFormData:!0})},u=()=>r.featured_image instanceof File?URL.createObjectURL(r.featured_image):a.featured_image?`/storage/${a.featured_image}`:null,b=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-pink-500",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"üìÖ Event Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Event Type"}),e.jsxs("select",{value:r.event_type,onChange:t=>s("event_type",t.target.value),className:"mt-1 w-full rounded-lg border-gray-300 focus:ring-pink-500 focus:border-pink-500",children:[e.jsx("option",{value:"meeting",children:"Meeting"}),e.jsx("option",{value:"election",children:"Election"}),e.jsx("option",{value:"rally",children:"Rally/Protest"}),e.jsx("option",{value:"program",children:"Cultural Program"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Venue"}),e.jsx("input",{type:"text",value:r.venue,onChange:t=>s("venue",t.target.value),placeholder:"e.g. Town Hall, Main Office",className:"mt-1 w-full rounded-lg border-gray-300 focus:ring-pink-500 focus:border-pink-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Start Date & Time"}),e.jsx("input",{type:"datetime-local",value:r.start_date?r.start_date.slice(0,16):"",onChange:t=>s("start_date",t.target.value),className:"mt-1 w-full rounded-lg border-gray-300 focus:ring-pink-500 focus:border-pink-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"End Date & Time"}),e.jsx("input",{type:"datetime-local",value:r.end_date?r.end_date.slice(0,16):"",onChange:t=>s("end_date",t.target.value),className:"mt-1 w-full rounded-lg border-gray-300 focus:ring-pink-500 focus:border-pink-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Organizer (Portfolio)"}),e.jsxs("select",{value:r.organizer_portfolio_id,onChange:t=>s("organizer_portfolio_id",t.target.value),className:"mt-1 w-full rounded-lg border-gray-300 focus:ring-pink-500 focus:border-pink-500",children:[e.jsx("option",{value:"",children:"Select Organizer..."}),d.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Audience"}),e.jsxs("div",{className:"flex gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"target_audience",value:"all_members",checked:r.target_audience==="all_members",onChange:t=>s("target_audience",t.target.value),className:"text-pink-600 focus:ring-pink-500"}),e.jsx("span",{className:"text-gray-900",children:"All Members"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"target_audience",value:"portfolio_holders",checked:r.target_audience==="portfolio_holders",onChange:t=>s("target_audience",t.target.value),className:"text-pink-600 focus:ring-pink-500"}),e.jsx("span",{className:"text-gray-900 font-bold",children:"Portfolio Holders Only"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 ml-1",children:r.target_audience==="all_members"?"Invite everyone in your jurisdiction.":"Invite only Office Bearers / Portfolio holders."})]})]})]})}),p=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6 border-l-4 border-red-500",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"üì¢ Official Communication Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Priority Level"}),e.jsxs("select",{value:r.priority,onChange:t=>s("priority",t.target.value),className:"mt-1 w-full rounded-lg border-gray-300 focus:ring-red-500 focus:border-red-500",children:[e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High Priority"}),e.jsx("option",{value:"urgent",children:"Urgent / Immediate"})]})]}),l.priority&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.priority}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Expiry Date"}),e.jsx("input",{type:"date",value:r.expiry_date,onChange:t=>s("expiry_date",t.target.value),className:"mt-1 w-full rounded-lg border-gray-300 focus:ring-red-500 focus:border-red-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Issuing Authority"}),e.jsxs("select",{value:r.organizer_portfolio_id,onChange:t=>s("organizer_portfolio_id",t.target.value),className:"mt-1 w-full rounded-lg border-gray-300 focus:ring-red-500 focus:border-red-500",children:[e.jsx("option",{value:"",children:"Select Authority..."}),d.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]})]})]})}),f=()=>e.jsxs("article",{className:"bg-white rounded-3xl shadow-xl overflow-hidden animate-in fade-in duration-300 border border-gray-200",children:[["notice","circular","announcement"].includes(r.category)&&e.jsxs("div",{className:`p-4 text-center text-white font-bold uppercase tracking-widest ${r.priority==="urgent"?"bg-red-600":"bg-blue-900"}`,children:["OFFICIAL ",r.category," ",r.priority==="urgent"&&"- URGENT"]}),u()?e.jsx("div",{className:"w-full bg-gray-100 flex items-center justify-center overflow-hidden rounded-lg mb-6",children:e.jsx("img",{src:u(),alt:"Preview",className:"w-full h-auto max-h-[600px] object-contain"})}):e.jsx("div",{className:"h-24 bg-gray-50 flex items-center justify-center text-gray-400",children:"No Image"}),e.jsxs("div",{className:"p-8 md:p-12",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 text-sm font-bold text-gray-500 border-b pb-4",children:[e.jsx("span",{className:"uppercase text-blue-600",children:r.category}),e.jsx("span",{children:"‚Ä¢"}),e.jsxs("span",{children:["Ref: ",a.id||"NEW"]}),e.jsx("span",{children:"‚Ä¢"}),e.jsx("span",{children:r.publish_date?new Date(r.publish_date).toLocaleDateString():"Date TBA"})]}),e.jsx("h1",{className:"text-3xl md:text-5xl font-extrabold text-gray-900 mb-6 leading-tight font-serif",children:r.title||"Untitled Post"}),e.jsx("p",{className:"text-xs font-bold text-pink-500 uppercase",children:"Ends"}),e.jsx("p",{className:"font-semibold text-gray-900",children:r.end_date?new Date(r.end_date).toLocaleString():"TBA"})]}),e.jsxs("div",{className:"p-8 md:p-12 border-t border-gray-100",children:[e.jsx("div",{className:"prose prose-lg max-w-none text-gray-800",dangerouslySetInnerHTML:{__html:r.content||"<p>No content...</p>"}}),["notice","circular","announcement"].includes(r.category)&&e.jsx("div",{className:"mt-12 pt-8 border-t border-gray-200 flex justify-end",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"font-bold text-gray-900",children:"Authorized Signatory"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Employees Union Portal"})]})})]}),e.jsx("div",{className:"bg-gray-50 p-6 text-center border-t",children:e.jsx("button",{onClick:()=>c(!1),className:"text-blue-600 font-bold hover:underline",children:"Exit Preview to Continue Editing"})})]});return e.jsxs(w,{user:o.user,header:`Edit ${r.category.charAt(0).toUpperCase()+r.category.slice(1)}`,children:[e.jsx(N,{title:`Edit ${r.category}`}),e.jsx("div",{className:"py-6 bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(_,{href:route(`${n}.blog.index`),className:"text-gray-500 hover:text-gray-900 flex items-center gap-1 text-sm font-medium mb-1",children:"‚Üê Back to Dashboard"}),e.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["‚úèÔ∏è Editing ",r.title]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"flex bg-white rounded-lg p-1 shadow-sm border",children:m.map(t=>e.jsx("button",{onClick:()=>s("category",t),className:`px-3 py-1.5 rounded text-xs font-bold capitalize transition ${r.category===t?"bg-black text-white":"text-gray-500 hover:bg-gray-100"}`,children:t},t))}),e.jsx("button",{type:"button",onClick:()=>c(!i),className:`px-4 py-2 rounded-lg font-bold transition flex items-center gap-2 border ${i?"bg-blue-600 text-white border-blue-600":"bg-white text-gray-700 border-gray-300 hover:border-gray-400"}`,children:i?"‚úèÔ∏è Edit":"üëÅÔ∏è Preview"})]})]}),i?f():e.jsxs("form",{onSubmit:h,className:"grid grid-cols-1 lg:grid-cols-12 gap-8 animate-in fade-in",children:[e.jsxs("div",{className:"lg:col-span-8 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Title / Subject"}),e.jsx("input",{type:"text",value:r.title,onChange:t=>s("title",t.target.value),className:"w-full text-xl font-bold border-gray-200 rounded-lg focus:ring-black focus:border-black",required:!0}),l.title&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:l.title})]}),r.category==="event"&&b(),["notice","circular","announcement"].includes(r.category)&&p(),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200 flex justify-between items-center",children:e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Content Body"})}),e.jsx("div",{className:"min-h-[400px]",children:e.jsx(k,{content:r.content,onChange:t=>s("content",t)})}),l.content&&e.jsx("p",{className:"p-4 text-red-500 text-sm",children:l.content})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2",children:"Short Summary"}),e.jsx("textarea",{value:r.excerpt,onChange:t=>s("excerpt",t.target.value),rows:"2",className:"w-full border-gray-200 rounded-lg focus:ring-black focus:border-black"})]})]}),e.jsxs("div",{className:"lg:col-span-4 space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-lg border border-gray-100 sticky top-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("span",{className:`inline-block px-3 py-1 rounded-full text-xs font-bold uppercase mb-2 ${r.status==="published"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:["Current: ",r.status]}),e.jsx("h3",{className:"font-bold text-gray-900",children:"Publishing"})]}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Status"}),e.jsxs("select",{value:r.status,onChange:t=>s("status",t.target.value),className:"w-full rounded-lg border-gray-200",children:[e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"published",children:"Published"}),e.jsx("option",{value:"archived",children:"Archived"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Visibility"}),e.jsxs("select",{value:r.visibility,onChange:t=>s("visibility",t.target.value),className:"w-full rounded-lg border-gray-200",children:[e.jsx("option",{value:"members_only",children:"Members Only"}),e.jsx("option",{value:"public",children:"Public"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Publish Date"}),e.jsx("input",{type:"datetime-local",value:r.publish_date?r.publish_date.slice(0,16):"",onChange:t=>s("publish_date",t.target.value),className:"w-full rounded-lg border-gray-200"})]})]}),e.jsx("button",{type:"submit",disabled:x,className:"w-full py-3 bg-black text-white rounded-xl font-bold hover:bg-gray-800 transition shadow-lg",children:x?"Saving...":"üíæ Save Changes"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-4",children:"Featured Image"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center hover:border-black transition cursor-pointer relative bg-gray-50",children:[e.jsx("input",{type:"file",onChange:t=>s("featured_image",t.target.files[0]),className:"absolute inset-0 opacity-0 cursor-pointer",accept:"image/*"}),e.jsx("label",{className:"cursor-pointer",children:r.featured_image?e.jsx("p",{className:"text-green-600 font-medium",children:"‚úì New Selected"}):e.jsxs("p",{className:"text-gray-500",children:["üì§ ",a.featured_image?"Replace Image":"Upload Image"]})})]}),a.featured_image&&!r.featured_image&&e.jsxs("div",{className:"mt-4",children:[e.jsx("img",{src:`/storage/${a.featured_image}`,alt:"Current",className:"rounded-lg w-full h-32 object-cover mb-3"}),e.jsx("button",{type:"button",onClick:()=>{confirm("Are you sure you want to remove this featured image?")&&router.delete(route(`${n}.blog.remove-image`,a.id),{preserveScroll:!0,onSuccess:()=>{}})},className:"w-full py-2 px-4 bg-red-50 text-red-600 border border-red-200 rounded-lg hover:bg-red-100 transition font-medium text-sm",children:"üóëÔ∏è Remove Featured Image"})]})]})]})]})]})})]})}export{D as default};
