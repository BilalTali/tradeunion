import{a as p,r as n,j as e,H as u,b as d}from"./app-D6okV9r1.js";import{A as b}from"./AuthenticatedLayout-BGHQQ68j.js";function y({election:c,pendingVotes:a}){const{auth:m}=p().props,[x,l]=n.useState(null),[t,i]=n.useState(""),o=(()=>{const s=window.location.pathname;if(s.includes("/tehsil/"))return"tehsil.ec";if(s.includes("/district/"))return"district.ec";if(s.includes("/state/"))return"state";const r=m.user?.role||"";return r==="super_admin"||r==="state_admin"?"state":r.includes("district")?"district":r.includes("tehsil")?"tehsil":"state"})(),h=s=>{confirm("Approve this vote? The vote will be counted.")&&d.post(route(`${o}.votes.approve`,s))},g=s=>{if(!t||t.length<10){alert("Please provide a detailed reason for rejection (minimum 10 characters)");return}d.post(route(`${o}.votes.reject`,s),{reason:t},{onSuccess:()=>{l(null),i("")}})};return e.jsxs(b,{children:[e.jsx(u,{title:"Verify Votes"}),e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Verify Votes"}),e.jsxs("p",{className:"text-gray-600",children:[c.title," - Pending Verification: ",a.length]})]}),a.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"All Votes Verified"}),e.jsx("p",{className:"text-gray-600",children:"There are no pending votes requiring verification."})]}):e.jsx("div",{className:"space-y-6",children:a.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-yellow-50 border-b border-yellow-200 p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900",children:["Voter: ",s.member.name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Submitted: ",new Date(s.created_at).toLocaleString("en-IN")]})]}),e.jsx("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-semibold",children:"Pending Verification"})]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Photo Verification"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Profile Photo"}),e.jsx("div",{className:"border-2 border-blue-300 rounded-lg overflow-hidden bg-gray-100",children:s.member.verified_photo_path||s.member.photo_path?e.jsx("img",{src:`/storage/${s.member.verified_photo_path||s.member.photo_path}`,alt:"Profile",className:"w-full h-64 object-cover",onError:r=>{r.target.onerror=null,r.target.src="https://ui-avatars.com/api/?name="+encodeURIComponent(s.member.name)+"&background=random"}}):e.jsx("div",{className:"w-full h-64 flex items-center justify-center bg-gray-200",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto mb-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),e.jsx("p",{className:"text-sm",children:"No profile photo"})]})})})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Live Captured Photo"}),e.jsx("div",{className:"border-2 border-green-300 rounded-lg overflow-hidden bg-gray-100",children:e.jsx("img",{src:`/storage/${s.live_photo_path}`,alt:"Live capture",className:"w-full h-64 object-cover"})})]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Voter Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Name:"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.member.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Member ID:"}),e.jsx("p",{className:"font-semibold text-gray-900",children:s.member.membership_id||"N/A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"IP Address:"}),e.jsx("p",{className:"font-semibold text-gray-900 font-mono text-xs",children:s.ip_address})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Vote Time:"}),e.jsx("p",{className:"font-semibold text-gray-900",children:new Date(s.created_at).toLocaleTimeString("en-IN")})]})]})]}),x===s.id?e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:["Rejection Reason ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:t,onChange:r=>i(r.target.value),placeholder:"Provide a detailed reason (e.g., photo mismatch, unclear face, etc.)...",rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg mb-3"}),e.jsxs("p",{className:"text-xs text-gray-600 mb-3",children:[t.length," / 10 minimum characters"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>g(s.id),disabled:t.length<10,className:"px-6 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800 font-semibold disabled:bg-gray-400",style:{backgroundColor:t.length<10?"#9ca3af":"#111827",color:"#ffffff"},children:"Confirm Rejection"}),e.jsx("button",{onClick:()=>{l(null),i("")},className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold",children:"Cancel"})]})]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsx("style",{children:`
                                                    #btn-approve { background-color: #16a34a !important; color: white !important; }
                                                    #btn-reject { background-color: #000000 !important; color: white !important; }
                                                `}),e.jsxs("button",{id:"btn-approve",onClick:()=>h(s.id),className:"flex-1 px-6 py-3 rounded-lg font-semibold transition shadow-md hover:shadow-lg flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Approve Vote"]}),e.jsxs("button",{id:"btn-reject",onClick:()=>l(s.id),className:"flex-1 px-6 py-3 rounded-lg font-semibold transition shadow-md hover:shadow-lg flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Reject Vote"]})]})]})]},s.id))})]})})]})}export{y as default};
