import{a as f,r as y,u as j,j as e,H as N}from"./app-D6okV9r1.js";import{A as w}from"./AuthenticatedLayout-BGHQQ68j.js";function S({post:a,roster:i}){const{auth:n}=f().props,[d,h]=y.useState(""),{data:c,setData:p,post:o,processing:x,recentlySuccessful:g}=j({attendance:i.map(t=>({member_id:t.member_id,status:t.status||"pending",notes:t.notes||""}))}),l=(t,s)=>{p("attendance",c.attendance.map(r=>r.member_id===t?{...r,status:s}:r))},b=()=>{const t=n.user.role==="super_admin"?"state":n.user.role.includes("district")?"district":"tehsil";o(route(`${t}.blog.attendance.store`,a.id))},u=t=>{const s=n.user.role==="super_admin"?"state":n.user.role.includes("district")?"district":"tehsil";confirm(`Are you sure you want to send ${t==="duty_slip"?"DUTY SLIPS":"ABSENT NOTICES"}? This will email members.`)&&o(route(`${s}.blog.attendance.notify`,a.id),{data:{type:t},preserveScroll:!0})},m=i.filter(t=>t.name.toLowerCase().includes(d.toLowerCase())||t.school_name?.toLowerCase().includes(d.toLowerCase()));return e.jsxs(w,{user:n.user,header:`Attendance: ${a.title}`,children:[e.jsx(N,{title:"Manage Attendance"}),e.jsx("div",{className:"py-8 bg-slate-100 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-sm p-6 mb-8 border border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:a.title}),e.jsxs("p",{className:"text-gray-500 mt-1",children:[new Date(a.start_date).toLocaleDateString()," ‚Ä¢ ",a.venue]}),e.jsx("div",{className:"mt-2 text-sm",children:e.jsx("span",{className:"bg-pink-100 text-pink-800 px-2 py-1 rounded-md font-bold text-xs uppercase mr-2",children:a.target_audience==="portfolio_holders"?"Portfolio Holders Only":"All Members"})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>u("duty_slip"),className:"px-4 py-2 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg hover:bg-blue-100 font-bold text-sm flex items-center gap-2",children:"üì© Send Duty Slips"}),e.jsx("button",{onClick:()=>u("absent_notice"),className:"px-4 py-2 bg-red-50 text-red-700 border border-red-200 rounded-lg hover:bg-red-100 font-bold text-sm flex items-center gap-2",children:"‚ö†Ô∏è Send Absent Notices"})]})]})}),e.jsxs("div",{className:"flex justify-between items-center mb-6 sticky top-0 z-10 bg-slate-100 py-4",children:[e.jsx("input",{type:"text",placeholder:"üîç Search members...",value:d,onChange:t=>h(t.target.value),className:"w-full max-w-sm rounded-lg border-gray-300 focus:ring-blue-500 focus:border-blue-500"}),e.jsx("button",{onClick:b,disabled:x,className:"bg-green-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-green-700 shadow-lg transition transform hover:scale-105",children:x?"Saving...":"üíæ Save Attendance"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Member"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Notifications"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:m.map(t=>{const s=c.attendance.find(r=>r.member_id===t.member_id)?.status||"pending";return e.jsxs("tr",{className:s==="absent"?"bg-red-50":s==="present"?"bg-green-50":"",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:t.photo_url?e.jsx("img",{className:"h-10 w-10 rounded-full object-cover",src:t.photo_url,alt:""}):e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-gray-500",children:"?"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.designation," ‚Ä¢ ",t.school_name]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsxs("div",{className:"inline-flex bg-white rounded-lg shadow-sm border border-gray-200 p-1",children:[e.jsx("button",{onClick:()=>l(t.member_id,"present"),className:`px-4 py-1.5 rounded-md text-sm font-bold transition ${s==="present"?"bg-green-500 text-white shadow":"text-gray-500 hover:bg-gray-100"}`,children:"Present"}),e.jsx("button",{onClick:()=>l(t.member_id,"absent"),className:`px-4 py-1.5 rounded-md text-sm font-bold transition ${s==="absent"?"bg-red-500 text-white shadow":"text-gray-500 hover:bg-gray-100"}`,children:"Absent"}),e.jsx("button",{onClick:()=>l(t.member_id,"excused"),className:`px-4 py-1.5 rounded-md text-sm font-bold transition ${s==="excused"?"bg-yellow-500 text-white shadow":"text-gray-500 hover:bg-gray-100"}`,children:"Excused"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-xs text-gray-500",children:e.jsxs("div",{className:"flex flex-col gap-1 items-center",children:[t.notification_sent&&e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-0.5 rounded-full inline-flex items-center gap-1",children:"üì© Slip Sent"}),t.absent_notice_sent&&e.jsx("span",{className:"bg-red-100 text-red-800 px-2 py-0.5 rounded-full inline-flex items-center gap-1",children:"‚ö†Ô∏è Notice Sent"}),!t.notification_sent&&!t.absent_notice_sent&&e.jsx("span",{className:"text-gray-400",children:"-"})]})})]},t.member_id)})})]}),m.length===0&&e.jsx("div",{className:"p-12 text-center text-gray-500",children:"No members found for this audience."})]})]})}),g&&e.jsx("div",{className:"fixed bottom-4 right-4 bg-green-600 text-white px-6 py-3 rounded-xl shadow-2xl animate-bounce",children:"‚úÖ Saved Successfully!"})]})}export{S as default};
