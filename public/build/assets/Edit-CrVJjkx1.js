import{a as f,u as j,j as e,H as y,b as x,L as N}from"./app-DmHEPWi5.js";import{A as v}from"./AuthenticatedLayout-BeN-Hvb4.js";function D({position:a,member:c,portfolio:g}){const{auth:p,errors:w}=f().props,d=(()=>{const r=p.user?.role||"";return r==="super_admin"?"state":r.includes("district")?"district":"tehsil"})(),{data:l,setData:n,put:h,processing:m,errors:s}=j({appointment_order_number:a.appointment_order_number||"",appointment_date:a.appointment_date||"",appointing_authority:a.appointing_authority||"",status:a.status||"active",signature_valid_from:a.signature_valid_from||"",signature_valid_to:a.signature_valid_to||"",portfolio_accepted_at:a.portfolio_accepted_at||"",admin_remarks:""}),b=r=>{r.preventDefault(),h(route(`${d}.portfolio-holders.update`,a.id))},u=a.signature_path&&a.seal_image_path;return e.jsxs(v,{children:[e.jsx(y,{title:`Edit Authority Data - ${c.name}`}),e.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:c.name}),e.jsx("p",{className:"text-lg text-gray-600 mt-1",children:a.position_title}),e.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Portfolio: ",g.name]})]}),e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-yellow-700",children:[e.jsx("strong",{children:"Warning:"})," Changes to authority data are logged and require mandatory remarks for audit purposes."]})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"1. Signature Specimen Upload"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current Signature"}),a.signature_path?e.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg inline-block",children:[e.jsx("div",{className:"bg-white border rounded p-2",children:e.jsx("img",{src:route(`${d}.portfolio-holders.image`,[a.id,"signature"])+`?t=${new Date(a.updated_at).getTime()}`,alt:"Current Signature",className:"h-[80px] w-[300px] object-contain",onError:r=>r.target.style.display="none"})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Last Updated: ",new Date(a.updated_at).toLocaleDateString()]})]}):e.jsx("div",{className:"h-[100px] w-full bg-gray-100 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center text-gray-400 text-sm",children:"No signature uploaded"})]})}),e.jsxs("form",{onSubmit:r=>{r.preventDefault();const t=new FormData(r.target);x.post(route(`${d}.portfolio-holders.signature`,a.id),t,{forceFormData:!0,onSuccess:()=>{}})},encType:"multipart/form-data",className:"mt-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["New Signature Image ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",name:"signature",accept:"image/*",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",onChange:r=>{const t=r.target.files[0];if(t){const i=new FileReader;i.onload=o=>{document.getElementById("signature-preview").src=o.target.result,document.getElementById("signature-preview-container").style.display="block"},i.readAsDataURL(t)}}}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"size: 300x80px (recommended)"}),e.jsxs("div",{id:"signature-preview-container",className:"mt-2 hidden",children:[e.jsx("p",{className:"text-xs font-semibold text-blue-600 mb-1",children:"New Selection Preview:"}),e.jsx("img",{id:"signature-preview",className:"h-[80px] w-auto border border-blue-300 rounded bg-white"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Valid From ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"valid_from",required:!0,defaultValue:new Date().toISOString().split("T")[0],className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Valid To ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"valid_to",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Admin Remarks ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{name:"admin_remarks",rows:2,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Reason for signature upload..."})]})]}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold",children:"Upload Signature"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"2. Official Seal Upload"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Current Seal"}),a.seal_image_path?e.jsx("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg inline-block",children:e.jsx("div",{className:"bg-white border rounded p-2",children:e.jsx("img",{src:route(`${d}.portfolio-holders.image`,[a.id,"seal"])+`?t=${new Date(a.updated_at).getTime()}`,alt:"Current Seal",className:"h-[150px] w-[150px] object-contain",onError:r=>r.target.style.display="none"})})}):e.jsx("div",{className:"h-[150px] w-[150px] bg-gray-100 rounded-lg border-2 border-dashed border-gray-300 flex items-center justify-center text-gray-400 text-sm",children:"No seal uploaded"})]})}),e.jsxs("form",{onSubmit:r=>{r.preventDefault();const t=new FormData(r.target);x.post(route(`${d}.portfolio-holders.seal`,a.id),t,{forceFormData:!0})},encType:"multipart/form-data",className:"mt-6",children:[e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["New Seal Image ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"file",name:"seal",accept:"image/*",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",onChange:r=>{const t=r.target.files[0];if(t){const i=new FileReader;i.onload=o=>{document.getElementById("seal-preview").src=o.target.result,document.getElementById("seal-preview-container").style.display="block"},i.readAsDataURL(t)}}}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"High Resolution (1000x1000px)"}),e.jsxs("div",{id:"seal-preview-container",className:"mt-2 hidden",children:[e.jsx("p",{className:"text-xs font-semibold text-green-600 mb-1",children:"New Selection Preview:"}),e.jsx("img",{id:"seal-preview",className:"h-[150px] w-auto border border-green-300 rounded bg-white"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Admin Remarks ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{name:"admin_remarks",rows:2,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Reason for seal upload..."})]})]}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold",children:"Upload Seal"})]})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"3. Appointment Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointment Order Number"}),e.jsx("input",{type:"text",value:l.appointment_order_number,onChange:r=>n("appointment_order_number",r.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., ORD/2024/001"}),s.appointment_order_number&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.appointment_order_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointment Date"}),e.jsx("input",{type:"date",value:l.appointment_date,onChange:r=>n("appointment_date",r.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),s.appointment_date&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.appointment_date})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Appointing Authority"}),e.jsx("input",{type:"text",value:l.appointing_authority,onChange:r=>n("appointing_authority",r.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., State Secretary"}),s.appointing_authority&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.appointing_authority})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Portfolio Accepted Date"}),e.jsx("input",{type:"date",value:l.portfolio_accepted_at,onChange:r=>n("portfolio_accepted_at",r.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Status ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:l.status,onChange:r=>n("status",r.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"relieved",children:"Relieved"}),e.jsx("option",{value:"suspended",children:"Suspended"})]}),s.status&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.status})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:["Admin Remarks ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Provide a detailed reason for these changes (minimum 10 characters). This will be logged for audit."}),e.jsx("textarea",{value:l.admin_remarks,onChange:r=>n("admin_remarks",r.target.value),rows:4,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Explain the reason for these changes...",required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[l.admin_remarks.length," / 10 minimum characters"]}),s.admin_remarks&&e.jsx("p",{className:"text-red-600 text-sm mt-1",children:s.admin_remarks})]}),!u&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-red-700",children:[e.jsx("strong",{children:"Incomplete Profile:"})," You must upload both a Signature and an Official Seal before you can save these details."]})})]})}),e.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"submit",disabled:m||l.admin_remarks.length<10||!u,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-semibold disabled:bg-gray-400 disabled:cursor-not-allowed",children:m?"Saving...":"Save Changes"}),e.jsx(N,{href:route(`${d}.portfolio-holders.show`,a.id),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-semibold",children:"Cancel"})]})]})]})})]})}export{D as default};
